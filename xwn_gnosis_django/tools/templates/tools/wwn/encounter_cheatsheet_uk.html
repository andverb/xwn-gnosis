{% extends "tools/base.html" %}

{% block title %}–®–ø–∞—Ä–≥–∞–ª–∫–∞ –ó—ñ—Ç–∫–Ω–µ–Ω—å WWN - –ì–Ω–æ–∑—ñ—Å{% endblock %}

{% block extra_head %}
<style>
    /* Alpine.js cloak */
    [x-cloak] { display: none !important; }
    /* Cheatsheet-specific styles */
    .cheatsheet-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
    }

    @media (max-width: 1200px) {
        .cheatsheet-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 768px) {
        .cheatsheet-grid {
            grid-template-columns: 1fr;
        }
    }

    .cheatsheet-card {
        background: var(--pico-card-background-color);
        border: 1px solid var(--pico-muted-border-color);
        border-radius: var(--pico-border-radius);
        padding: 1rem;
    }

    .cheatsheet-card h3 {
        margin-top: 0;
        margin-bottom: 0.75rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid var(--pico-primary);
    }

    .dice {
        font-family: monospace;
        font-weight: bold;
        color: var(--pico-primary);
        cursor: pointer;
        padding: 0.1rem 0.4rem;
        border-radius: 0.25rem;
        transition: all 0.15s ease;
    }

    .dice:hover {
        background-color: var(--pico-primary-focus);
    }

    .dice.rolled {
        background-color: var(--pico-primary);
        color: white;
    }

    .compact-table {
        width: 100%;
        font-size: 0.85rem;
        border-collapse: collapse;
        margin: 0.5rem 0;
    }

    .compact-table th,
    .compact-table td {
        padding: 0.3rem 0.5rem;
        border-bottom: 1px solid var(--pico-muted-border-color);
    }

    .compact-table th {
        text-align: left;
        font-weight: 600;
        color: var(--pico-muted-color);
        font-size: 0.75rem;
        text-transform: uppercase;
    }

    .compact-table td:first-child {
        font-weight: bold;
        color: var(--pico-primary);
        width: 3rem;
        text-align: center;
    }

    .compact-table td:last-child {
        color: var(--pico-muted-color);
    }

    .compact-table tbody tr:last-child td {
        border-bottom: none;
    }

    /* Turn Tracker */
    .turn-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 0.5rem;
    }

    .turn-table th,
    .turn-table td {
        padding: 0.25rem;
        text-align: center;
        border: 1px solid var(--pico-muted-border-color);
    }

    .turn-table th {
        font-size: 0.7rem;
        font-weight: 600;
        color: var(--pico-muted-color);
        background: var(--pico-code-background-color);
    }

    .turn-table .row-label {
        font-size: 0.7rem;
        font-weight: 600;
        color: var(--pico-muted-color);
        background: var(--pico-code-background-color);
        width: 3rem;
    }

    .turn-table input[type="checkbox"] {
        margin: 0;
        width: 1.1rem;
        height: 1.1rem;
    }

    .turn-legend {
        display: flex;
        gap: 1rem;
        align-items: center;
        font-size: 0.75rem;
        color: var(--pico-muted-color);
    }

    .turn-table .reset-btn {
        width: 1.5rem;
        height: 1.5rem;
        padding: 0;
        font-size: 0.9rem;
        line-height: 1;
        margin: 0;
        min-width: auto;
    }

    .time-costs {
        font-size: 0.85rem;
        color: var(--pico-muted-color);
    }

    .modifier-positive { color: #198754; font-weight: bold; }
    .modifier-negative { color: #dc3545; font-weight: bold; }

    .variant {
        color: #6f42c1;
        cursor: help;
        border-bottom: 1px dotted #6f42c1;
    }

    [data-theme="dark"] .variant {
        color: #b794f6;
        border-bottom-color: #b794f6;
    }

    .action-item {
        margin-bottom: 1rem;
        padding-bottom: 0.75rem;
        border-bottom: 1px solid var(--pico-muted-border-color);
    }

    .action-item:last-child {
        margin-bottom: 0;
        padding-bottom: 0;
        border-bottom: none;
    }

    .action-item h4 {
        margin: 0 0 0.25rem 0;
        font-size: 1rem;
    }

    .action-item p, .action-item ul,
    .cheatsheet-card > ul {
        margin: 0;
        font-size: 0.9rem;
        color: var(--pico-muted-color);
    }

    .action-item ul,
    .cheatsheet-card > ul {
        padding-left: 1.2rem;
        margin-top: 0.25rem;
    }

    .action-item li,
    .cheatsheet-card > ul > li {
        margin-bottom: 0.25rem;
    }

    .formula-box {
        background: var(--pico-code-background-color);
        padding: 0.75rem;
        border-radius: 0.25rem;
        font-family: monospace;
        font-size: 1rem;
        margin: 0.5rem 0;
        text-align: center;
    }

    .trigger-list {
        font-size: 0.85rem;
    }

    .trigger-list li {
        margin-bottom: 0.4rem;
        padding-left: 0.5rem;
        border-left: 3px solid var(--pico-primary);
    }

    .instinct-table {
        font-size: 0.85rem;
        width: 100%;
        margin: 0.5rem 0;
    }

    .instinct-table .inst-row {
        display: flex;
        justify-content: space-between;
        padding: 0.3rem 0;
        border-bottom: 1px solid var(--pico-muted-border-color);
    }

    .instinct-table .inst-row:last-child {
        border-bottom: none;
    }

    .instinct-table .inst-score {
        font-weight: bold;
        color: var(--pico-primary);
        min-width: 2rem;
    }

    .instinct-table .inst-desc {
        color: var(--pico-muted-color);
    }

    /* Reaction table with color coding */
    .reaction-table {
        font-size: 0.85rem;
        width: 100%;
    }

    .reaction-row {
        display: flex;
        gap: 0.5rem;
        padding: 0.35rem 0.5rem;
        border-radius: 0.25rem;
        margin-bottom: 0.25rem;
    }

    .reaction-row:last-child {
        margin-bottom: 0;
    }

    .reaction-score {
        font-weight: bold;
        min-width: 2.5rem;
    }

    .reaction-hostile {
        background: rgba(220, 53, 69, 0.2);
    }

    .reaction-unfriendly {
        background: rgba(253, 126, 20, 0.15);
    }

    .reaction-neutral {
        background: rgba(255, 193, 7, 0.15);
    }

    .reaction-friendly {
        background: rgba(25, 135, 84, 0.15);
    }

    .reaction-helpful {
        background: rgba(25, 135, 84, 0.25);
    }

    /* Light mode colors */
    [data-theme="light"] .reaction-hostile { color: #dc3545; }
    [data-theme="light"] .reaction-unfriendly { color: #d67212; }
    [data-theme="light"] .reaction-neutral { color: #806600; }
    [data-theme="light"] .reaction-friendly { color: #157347; }
    [data-theme="light"] .reaction-helpful { color: #0f5132; }

    /* Dark mode colors */
    [data-theme="dark"] .reaction-hostile { color: #ff6b7a; }
    [data-theme="dark"] .reaction-unfriendly { color: #ffa64d; }
    [data-theme="dark"] .reaction-neutral { color: #ffda6a; }
    [data-theme="dark"] .reaction-friendly { color: #5dd39e; }
    [data-theme="dark"] .reaction-helpful { color: #75e8b0; }

    /* Column span utilities */
    .full-width {
        grid-column: 1 / -1;
    }

    .span-2 {
        grid-column: span 2;
    }

    @media (max-width: 768px) {
        .span-2 {
            grid-column: span 1;
        }
    }

    /* Calculator specific styles */
    .calculator-sides {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.5rem;
        margin-bottom: 0.75rem;
    }

    .calculator-side {
        background: var(--pico-code-background-color);
        padding: 0.75rem;
        border-radius: 0.5rem;
    }

    .calculator-side h4 {
        margin: 0 0 0.5rem 0;
        font-size: 0.9rem;
        text-align: center;
    }

    .side-foes h4 { color: #dc3545; }
    .side-party h4 { color: #198754; }

    .calculator-side .field-row {
        display: flex;
        gap: 0.5rem;
    }

    .calculator-side .field-group {
        flex: 1;
        text-align: center;
    }

    .calculator-side input {
        margin-bottom: 0;
        padding: 0.4rem;
        text-align: center;
        width: 100%;
    }

    .calculator-side .field-label {
        font-size: 0.7rem;
        color: var(--pico-muted-color);
        display: block;
        margin-top: 0.2rem;
    }

    .calculator-result {
        background: var(--pico-code-background-color);
        padding: 1rem;
        border-radius: 0.5rem;
        text-align: center;
    }

    .calculator-result .scores {
        display: flex;
        justify-content: space-around;
        margin-bottom: 0.75rem;
        font-size: 0.9rem;
    }

    .calculator-result .score-box {
        text-align: center;
    }

    .calculator-result .score-value {
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--pico-primary);
    }

    .calculator-result .score-label {
        font-size: 0.75rem;
        color: var(--pico-muted-color);
    }

    .calculator-result .verdict {
        font-weight: bold;
        padding: 0.5rem;
        border-radius: 0.25rem;
        margin-top: 0.5rem;
    }

    .verdict-rout { background: #dc3545; color: white; }
    .verdict-deadly { background: #fd7e14; color: white; }
    .verdict-hard { background: #ffc107; color: #212529; }
    .verdict-fair { background: #198754; color: white; }
    .verdict-easy { background: #0d6efd; color: white; }

    .challenge-legend {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 0.4rem;
        margin-top: 0.75rem;
    }

    .challenge-legend .legend-item {
        font-size: 0.7rem;
        font-weight: bold;
        padding: 0.2rem 0.5rem;
        border-radius: 0.25rem;
    }

    .back-link {
        margin-bottom: 1rem;
    }
</style>
{% endblock %}

{% block content %}
<hgroup style="text-align: center; margin-bottom: 2rem;">
    <h1>–®–ø–∞—Ä–≥–∞–ª–∫–∞ –ó—ñ—Ç–∫–Ω–µ–Ω—å WWN</h1>
</hgroup>

<div class="cheatsheet-grid">

    <!-- Ruin Turns & Encounters -->
    <article class="cheatsheet-card" x-data="turnTracker">
        <h3>–•–æ–¥–∏ & –ó—ñ—Ç–∫–Ω–µ–Ω–Ω—è</h3>

        <table class="turn-table">
            <thead>
                <tr>
                    <th><button class="reset-btn" @click="turns = 0" title="–°–∫–∏–Ω—É—Ç–∏">‚Ü∫</button></th>
                    <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="row-label">
                        <span x-show="turns < 6" x-text="time"></span>
                        <span x-show="turns >= 6">üî•</span>
                    </td>
                    <template x-for="i in 6" :key="i">
                        <td><input type="checkbox" :checked="turns >= i" @change="turns = turns >= i ? i - 1 : i"></td>
                    </template>
                </tr>
                <tr>
                    <td class="row-label">
                        <span x-show="turns >= 6 && turns < 12" x-text="time"></span>
                        <span x-show="turns >= 12">üî•</span>
                    </td>
                    <template x-for="i in 6" :key="i + 6">
                        <td><input type="checkbox" :checked="turns >= i + 6" @change="turns = turns >= i + 6 ? i + 5 : i + 6"></td>
                    </template>
                </tr>
                <tr>
                    <td class="row-label">
                        <span x-show="turns >= 12 && turns < 18" x-text="time"></span>
                        <span x-show="turns >= 18">üî•</span>
                    </td>
                    <template x-for="i in 6" :key="i + 12">
                        <td><input type="checkbox" :checked="turns >= i + 12" @change="turns = turns >= i + 12 ? i + 11 : i + 12"></td>
                    </template>
                </tr>
                <tr>
                    <td class="row-label">
                        <span x-show="turns >= 18 && turns < 24" x-text="time"></span>
                        <span x-show="turns >= 24">üî•üèÆ</span>
                    </td>
                    <template x-for="i in 6" :key="i + 18">
                        <td><input type="checkbox" :checked="turns >= i + 18" @change="turns = turns >= i + 18 ? i + 17 : i + 18"></td>
                    </template>
                </tr>
            </tbody>
        </table>

        <div class="turn-legend">
            <span>üî• —Å–º–æ–ª–æ—Å–∫–∏–ø (6 —Ö–æ–¥—ñ–≤ )</span>
            <span>üèÆ –ª—ñ—Ö—Ç–∞—Ä (24 —Ö–æ–¥–∏ )</span>
        </div>

        <p style="font-size: 0.85rem; color: var(--pico-muted-color); margin: 0.75rem 0;">
            –ö–æ–∂–µ–Ω —Ö—ñ–¥ ‚âà 10 —Ö–≤–∏–ª–∏–Ω. <strong>1 —Ö—ñ–¥:</strong> —Ä—É—Ö –º—ñ–∂ –∫—ñ–º–Ω–∞—Ç–∞–º–∏, –∑–ª–æ–º –∑–∞–º–∫–∞, –∑–Ω–µ—à–∫–æ–¥–∂–µ–Ω–Ω—è –ø–∞—Å—Ç–∫–∏, –±—ñ–π, –ø–µ—Ä—à–∞ –¥–æ–ø–æ–º–æ–≥–∞ & –æ–±—à—É–∫, –æ–±—à—É–∫ –∫—ñ–º–Ω–∞—Ç–∏, –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∏, —ñ–º–ø—Ä–æ–≤—ñ–∑–æ–≤–∞–Ω–∏–π —Ä–µ–º–æ–Ω—Ç.
        </p>

        <div class="action-item">
            <h4>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ó—ñ—Ç–∫–Ω–µ–Ω–Ω—è</h4>
            <p>–ö–∏–¥–æ–∫ <span class="dice" x-data="rollable" data-notation="1d6" @click="roll()" :class="{ 'rolled': rolled }" title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –∫–∏–¥–∫–∞" x-text="displayText">1–∫6</span>. –ó—ñ—Ç–∫–Ω–µ–Ω–Ω—è –Ω–∞ 1 (–∞–±–æ 1-2 –≤ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –∑–æ–Ω–∞—Ö). –í—ñ–¥—Å—Ç–∞–Ω—å: –∫—ñ–º–Ω–∞—Ç–∞ = –≤—Ö—ñ–¥, –∫–æ—Ä–∏–¥–æ—Ä = <span class="dice" x-data="rollable" data-notation="1d8" @click="roll()" :class="{ 'rolled': rolled }" title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –∫–∏–¥–∫–∞" x-text="displayText">1–∫8</span> √ó 10 —Ñ—É—Ç—ñ–≤.</p>
        </div>

        <div class="action-item">
            <h4>–ß–∞—Å—Ç–æ—Ç–∞ –ü–µ—Ä–µ–≤—ñ—Ä–æ–∫</h4>
            <table class="compact-table">
                <thead>
                    <tr><th>–•–æ–¥—ñ–≤</th><th>–¢–∏–ø –õ–æ–∫–∞—Ü—ñ—ó</th></tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td>–ú—ñ—Å—Ü–µ –≤ —Å—Ç–∞–Ω—ñ —Ç—Ä–∏–≤–æ–≥–∏, –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–∞ –æ–±–æ—Ä–æ–Ω–∞</td></tr>
                    <tr><td>2</td><td>–°–ø–æ–∫—ñ–π–Ω–µ –º—ñ—Å—Ü–µ, –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–∞ –æ–±–æ—Ä–æ–Ω–∞</td></tr>
                    <tr><td>3</td><td>–ë–µ–∑ –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–æ—ó –∞–±–æ –∞–∫—Ç–∏–≤–Ω–æ—ó –æ–±–æ—Ä–æ–Ω–∏</td></tr>
                    <tr><td>4</td><td>–î—É–∂–µ –º–∞–ª–æ –º–æ–±—ñ–ª—å–Ω–∏—Ö –º–µ—à–∫–∞–Ω—Ü—ñ–≤</td></tr>
                    <tr><td>6</td><td>–ü–æ–∫–∏–Ω—É—Ç–µ –∞–±–æ –∑–∞–Ω–µ–¥–±–∞–Ω–µ –º—ñ—Å—Ü–µ</td></tr>
                    <tr><td>‚Äî</td><td>–ü—Ä–∏—Ö–æ–≤–∞–Ω–∞ –∫—ñ–º–Ω–∞—Ç–∞, –Ω–µ–≤—ñ–¥–æ–º–∞ –º—ñ—Å—Ü–µ–≤–∏–º</td></tr>
                </tbody>
            </table>
        </div>
    </article>

    <!-- Reaction Rolls -->
    <article class="cheatsheet-card">
        <h3>–ö–∏–¥–∫–∏ –Ω–∞ –†–µ–∞–∫—Ü—ñ—é</h3>

        <div class="action-item">
            <div class="formula-box">
                <span class="dice" x-data="rollable" data-notation="2d6" @click="roll()" :class="{ 'rolled': rolled }" title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –∫–∏–¥–∫–∞" x-text="displayText">2–∫6</span> + –º–æ–¥. –•–ê–†
                (—è–∫—â–æ –ü–ì –º–æ–∂—É—Ç—å –ø—Ä–∏–≤—ñ—Ç–∞—Ç–∏—Å—å)
            </div>
            <p>–ö–∏–¥–∞–π—Ç–µ –¥–ª—è –∫–æ–∂–Ω–æ—ó –∑—É—Å—Ç—Ä—ñ—á—ñ, –æ–∫—Ä—ñ–º –≤–∏–ø–∞–¥–∫—ñ–≤ –Ω–µ–º–∏–Ω—É—á–æ–≥–æ –∫—Ä–æ–≤–æ–ø—Ä–æ–ª–∏—Ç—Ç—è. –î–∞–π—Ç–µ –ü–ì –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ —ó—Ö–Ω—ñ—Ö –¥—ñ–π.</p>
        </div>

        <div class="action-item">
            <div class="reaction-table">
                <div class="reaction-row reaction-hostile">
                    <span class="reaction-score">2-</span>
                    <span class="reaction-desc">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ—Ä–æ–∂–∞</span>
                </div>
                <div class="reaction-row reaction-unfriendly">
                    <span class="reaction-score">3-5</span>
                    <span class="reaction-desc">–ë—ñ–ª—å—à –≤–æ—Ä–æ–∂–∞, –Ω—ñ–∂ –æ—á—ñ–∫—É–≤–∞–ª–æ—Å—å</span>
                </div>
                <div class="reaction-row reaction-neutral">
                    <span class="reaction-score">6-8</span>
                    <span class="reaction-desc">–ü–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–æ –≤–æ—Ä–æ–∂–∞ –∞–±–æ –¥—Ä—É–∂–Ω—è</span>
                </div>
                <div class="reaction-row reaction-friendly">
                    <span class="reaction-score">9-11</span>
                    <span class="reaction-desc">–ë—ñ–ª—å—à –¥—Ä—É–∂–Ω—è, –Ω—ñ–∂ –æ—á—ñ–∫—É–≤–∞–ª–æ—Å—å</span>
                </div>
                <div class="reaction-row reaction-helpful">
                    <span class="reaction-score">12+</span>
                    <span class="reaction-desc">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥—Ä—É–∂–Ω—è, –≥–æ—Ç–æ–≤—ñ –¥–æ–ø–æ–º–∞–≥–∞—Ç–∏</span>
                </div>
            </div>
        </div>

        <div class="action-item">
            <h4>–ú–∏—Ä–Ω—ñ –†–µ–∞–∫—Ü—ñ—ó</h4>
            <p style="font-size: 0.8rem; color: var(--pico-muted-color); margin-bottom: 0.5rem;">–©–æ –æ–∑–Ω–∞—á–∞—î "–¥—Ä—É–∂–Ω—è" —Ä–µ–∞–∫—Ü—ñ—è –¥–ª—è –≤–æ—Ä–æ–∂–∏—Ö –≥—Ä—É–ø:</p>
            <ul>
                <li><strong>–í–∏–º–∞–≥–∞—é—Ç—å —Ö–∞–±–∞—Ä</strong> - –ì—Ä–æ—à—ñ, —Å–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è, —ó–∂–∞, –ø–æ—Ö–≤–∞–ª–∞; –º–æ–∂–ª–∏–≤–∏–π —Ç–æ—Ä–≥</li>
                <li><strong>–í—ñ–¥—Å—Ç—É–ø–∞—é—Ç—å</strong> - –¢—Ä–∏–º–∞—é—Ç—å –¥–∏—Å—Ç–∞–Ω—Ü—ñ—é, –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—å –≥—Ä—É–ø—É; –º–æ–∂—É—Ç—å –¥–æ–Ω–µ—Å—Ç–∏ –ø—ñ–∑–Ω—ñ—à–µ</li>
                <li><strong>–ü—Ä–æ—Å—è—Ç—å –ø—Ä–æ –ø–æ—Å–ª—É–≥—É</strong> - –í–±–∏—Ç–∏ –≤–æ—Ä–æ–≥–∞, –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è; –∑–∞ —Ü–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å –ü–ì</li>
                <li><strong>–ü—Ä–æ–ø–æ–Ω—É—é—Ç—å –¥–∞–Ω–∏–Ω—É</strong> - –ë–∞–≥–∞—Ç—Å—Ç–≤–æ, —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è, –ø–æ—Å–ª—É–≥–∏, —â–æ–± —ó—Ö –∑–∞–ª–∏—à–∏–ª–∏ –≤ —Å–ø–æ–∫–æ—ó</li>
                <li><strong>–û—Ö–æ—á–µ —Å–ø—ñ–ª–∫—É—é—Ç—å—Å—è</strong> - –°–∞–º–æ—Ç–Ω—ñ, –ø–µ—Ä–µ–ø–ª—É—Ç–∞–ª–∏ –∑ –∫–∏–º–æ—Å—å –∑–Ω–∞–π–æ–º–∏–º, –∞–±–æ –ø—Ä–æ—Å—Ç–æ –±–∞–ª–∞–∫—É—á—ñ</li>
            </ul>
        </div>

        <p style="font-size: 0.85rem; color: var(--pico-muted-color);">
            <strong>–ü–∞–º'—è—Ç–∞–π—Ç–µ:</strong> –ö–∏–¥–∫–∏ –Ω–∞ —Ä–µ–∞–∫—Ü—ñ—é - –ª–∏—à–µ –ø–æ—á–∞—Ç–æ–∫. –†–æ–∑—É–º–Ω—ñ —Å–ª–æ–≤–∞, –¥–∞—Ä—É–Ω–∫–∏ –∞–±–æ –æ–±—Ä–∞–∑–∏ –º–æ–∂—É—Ç—å –∑–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞–≤–ª–µ–Ω–Ω—è.
        </p>
    </article>

    <!-- Surprise & Initiative -->
    <article class="cheatsheet-card">
        <h3>–ó–∞—Å—ñ–¥–∫–∏ & –Ü–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∞</h3>

        <div class="action-item">
            <h4>–ù–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∫–∞</h4>
            <p>–Ø–∫—â–æ –ì–ú –≤–∏—Ä—ñ—à—É—î, —â–æ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∫–∞ –º–æ–∂–ª–∏–≤–∞, –∫–∏–¥–æ–∫ <strong>–ú–£–î/–£–í–ê–ì–ê</strong> –ø—Ä–æ—Ç–∏ <strong>–°–ü–†/–°–ö–†–ê–î–ê–ù–ù–Ø</strong>. –Ø–∫—â–æ –∞—Ç–∞–∫—É—é—á—ñ –ø–µ—Ä–µ–º–∞–≥–∞—é—Ç—å, –≤–æ–Ω–∏ –¥—ñ—é—Ç—å –ø–æ–≤–Ω–∏–π —Ä–∞—É–Ω–¥ –ø–µ—Ä–µ–¥ –∫–∏–¥–∫–æ–º —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∏.</p>
            <p style="font-size: 0.85rem; color: var(--pico-muted-color);">–ó–∞—Å—ñ–¥–∫–∞ –º–æ–∂–µ —Å–ø—Ä–æ–≤–æ–∫—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ú–æ—Ä–∞–ª—ñ —É –Ω–µ–≤—ñ–π—Å—å–∫–æ–≤–∏—Ö –∞–±–æ –Ω–µ–¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–æ–≤–∞–Ω–∏—Ö —Ü—ñ–ª–µ–π (–Ω–∞ —Ä–æ–∑—Å—É–¥ –ì–ú).</p>
        </div>

        <div class="action-item">
            <h4>–Ü–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∞</h4>
            <div class="formula-box">
                <span class="dice" x-data="rollable" data-notation="1d8" @click="roll()" :class="{ 'rolled': rolled }" title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –∫–∏–¥–∫–∞" x-text="displayText">1–∫8</span> + –Ω–∞–π–≤–∏—â–∏–π –º–æ–¥. –°–ü–† <span class="variant" data-tooltip="–í–∞—Ä—ñ–∞–Ω—Ç –ø—Ä–∞–≤–∏–ª–∞">(–∞–±–æ –Ü–ù–¢)</span>
            </div>
            <p>–ö–æ–∂–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ –∫–∏–¥–∞—î. –ü–µ—Ä–µ–º–æ–∂—Ü—ñ –¥—ñ—é—Ç—å –ø–µ—Ä—à–∏–º–∏ —É –±—É–¥—å-—è–∫–æ–º—É –ø–æ—Ä—è–¥–∫—É, –ø–æ—Ç—ñ–º —ñ–Ω—à–∞ —Å—Ç–æ—Ä–æ–Ω–∞. –ù–Ü–ü–∏ –∑–∞–∑–≤–∏—á–∞–π –±–µ–∑ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤, —è–∫—â–æ –Ω–µ —à–≤–∏–¥–∫—ñ. –ü–ì –ø–µ—Ä–µ–º–∞–≥–∞—é—Ç—å —É –Ω—ñ—á–∏—ó—Ö.</p>
            <p style="font-size: 0.8rem; color: var(--pico-muted-color); margin-top: 0.5rem;"><span class="variant" data-tooltip="–í–∞—Ä—ñ–∞–Ω—Ç —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ—ó —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∏">–í–∞—Ä—ñ–∞–Ω—Ç:</span> –ö–æ–∂–µ–Ω —É—á–∞—Å–Ω–∏–∫ –∫–∏–¥–∞—î –≤–ª–∞—Å–Ω—É —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤—É —Ç–∞ –¥—ñ—î –ø–æ –ø–æ—Ä—è–¥–∫—É.</p>
        </div>

        <div class="action-item">
            <h4>–í—Ç–µ—á–∞ & –ü–æ—Ä—è—Ç—É–Ω–æ–∫</h4>
            <p>–Ø–∫—â–æ –≤–æ—Ä–æ–≥–∏ –ø–µ—Ä–µ—Å–ª—ñ–¥—É—é—Ç—å (–±–∞–≥–∞—Ç–æ –Ω–µ —Ä–æ–±–ª—è—Ç—å —Ü—å–æ–≥–æ), –≤—Ç—ñ–∫–∞—á —ñ–∑ –Ω–∞–π–∫—Ä–∞—â–æ—é <strong>–°–ü–†/–ê–¢–õ–ï–¢–ò–ö–ê</strong> –∫–∏–¥–∞—î –ø—Ä–æ—Ç–∏ –Ω–∞–π—à–≤–∏–¥—à–æ–≥–æ –ø–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞—á–∞. –£—Å–ø—ñ—Ö = ~1 —Ö—ñ–¥ –¥–æ –±–µ–∑–ø–µ–∫–∏.</p>
            <div class="instinct-table" style="margin-top: 0.5rem;">
                <div class="inst-row">
                    <span class="inst-desc">–í—Ç—ñ–∫–∞—á—ñ–≤ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ –ø–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞—á—ñ–≤</span>
                    <span class="inst-score modifier-positive">+1</span>
                </div>
                <div class="inst-row">
                    <span class="inst-desc">–•–æ—Ä–æ—à–∏–π –ø–ª–∞–Ω –≤—Ç–µ—á—ñ</span>
                    <span class="inst-score modifier-positive">+1</span>
                </div>
                <div class="inst-row">
                    <span class="inst-desc">–°–ø–æ–≤—ñ–ª—å–Ω–µ–Ω—ñ –Ω–∞–π–ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏–º —á–ª–µ–Ω–æ–º</span>
                    <span class="inst-score modifier-negative">-2</span>
                </div>
            </div>
        </div>
    </article>

    <!-- Challenge Calculator -->
    <article class="cheatsheet-card">
        <h3>–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –°–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ</h3>

        <form id="challenge-form"
              hx-post="{% url 'tools:calculate_challenge' %}"
              hx-target="#calculator-result"
              hx-trigger="load, input delay:150ms, submit"
              hx-swap="innerHTML"
              hx-headers='{"Accept-Language": "uk"}'
              autocomplete="off">
            <input type="hidden" name="lang" value="uk">
            <div class="calculator-sides">
                <div class="calculator-side side-foes">
                    <h4>–í–æ—Ä–æ–≥–∏</h4>
                    <div class="field-row">
                        <div class="field-group">
                            <input type="number" id="total_hd" name="total_hd" min="1" value="1">
                            <span class="field-label">–ö–• (—Å—É–º–º–∞)</span>
                        </div>
                        <div class="field-group">
                            <input type="number" id="total_attacks" name="total_attacks" min="1" value="1">
                            <span class="field-label">–ê—Ç–∞–∫–∏ (—Å—É–º–º–∞)</span>
                        </div>
                    </div>
                </div>
                <div class="calculator-side side-party">
                    <h4>–ì—Ä—É–ø–∞</h4>
                    <div class="field-row">
                        <div class="field-group">
                            <input type="number" id="num_pcs" name="num_pcs" min="1" value="4">
                            <span class="field-label">–ö-—Å—Ç—å –ü–ì</span>
                        </div>
                        <div class="field-group">
                            <input type="number" id="total_pc_levels" name="total_pc_levels" min="1" value="4">
                            <span class="field-label">–†—ñ–≤–Ω—ñ (—Å—É–º–º–∞)</span>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <div id="calculator-result">
            {% include "tools/wwn/partials/_challenge_result_uk.html" %}
        </div>

        <div class="challenge-legend">
            <span class="legend-item verdict-rout">&gt;4√ó –†–æ–∑–≥—Ä–æ–º</span>
            <span class="legend-item verdict-deadly">~2√ó –°–º–µ—Ä—Ç–µ–ª—å–Ω–æ</span>
            <span class="legend-item verdict-hard">&gt;1√ó –í–∞–∂–∫–æ</span>
            <span class="legend-item verdict-fair">‚â§1√ó –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ</span>
            <span class="legend-item verdict-easy">&lt;¬Ω√ó –õ–µ–≥–∫–æ</span>
        </div>
    </article>

    <script>
    (function() {
        const hdInput = document.getElementById('total_hd');
        const attacksInput = document.getElementById('total_attacks');
        const pcsInput = document.getElementById('num_pcs');
        const levelsInput = document.getElementById('total_pc_levels');

        // Foes: HD up ‚Üí attacks bumps up; attacks down ‚Üí HD drops
        hdInput.addEventListener('input', function() {
            const hd = parseInt(this.value) || 1;
            const attacks = parseInt(attacksInput.value) || 1;
            if (attacks < hd) attacksInput.value = hd;
        });

        attacksInput.addEventListener('input', function() {
            const hd = parseInt(hdInput.value) || 1;
            const attacks = parseInt(this.value) || 1;
            if (attacks < hd) hdInput.value = attacks;
        });

        // Party: PCs up ‚Üí levels bumps up; levels down ‚Üí PCs drops
        pcsInput.addEventListener('input', function() {
            const pcs = parseInt(this.value) || 1;
            const levels = parseInt(levelsInput.value) || 1;
            if (levels < pcs) levelsInput.value = pcs;
        });

        levelsInput.addEventListener('input', function() {
            const pcs = parseInt(pcsInput.value) || 1;
            const levels = parseInt(this.value) || 1;
            if (levels < pcs) pcsInput.value = levels;
        });
    })();
    </script>

    <!-- Morale Checks -->
    <article class="cheatsheet-card">
        <h3>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ú–æ—Ä–∞–ª—ñ</h3>

        <div class="action-item">
            <div class="formula-box">
                <span class="dice" x-data="rollable" data-notation="2d6" @click="roll()" :class="{ 'rolled': rolled }" title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –∫–∏–¥–∫–∞" x-text="displayText">2–∫6</span> &gt; –ú–æ—Ä–∞–ª—å = <span class="modifier-negative">–ü—Ä–æ–≤–∞–ª</span>
            </div>
            <p>–ü—Ä–∏ –ø—Ä–æ–≤–∞–ª—ñ: –ù–Ü–ü –≤—ñ–¥—Å—Ç—É–ø–∞—î, –∑–¥–∞—î—Ç—å—Å—è –∞–±–æ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤—Ç–µ–∫—Ç–∏.</p>
        </div>

        <div class="action-item">
            <h4>–ö–æ–ª–∏ –ö–∏–¥–∞—Ç–∏</h4>
            <ul class="trigger-list">
                <li><strong>–ü–µ—Ä—à–∞ –≤—Ç—Ä–∞—Ç–∞</strong> - –ö–æ–ª–∏ –ø–µ—Ä—à–æ–≥–æ —á–ª–µ–Ω–∞ –≥—Ä—É–ø–∏ –≤–±–∏—Ç–æ –∞–±–æ –≤–∏–≤–µ–¥–µ–Ω–æ –∑ –±–æ—é</li>
                <li><strong>–ü—Ä–æ–≥—Ä–∞—é—Ç—å</strong> - –ì—Ä—É–ø–∞ –ø–æ—á–∏–Ω–∞—î –æ—á–µ–≤–∏–¥–Ω–æ –ø—Ä–æ–≥—Ä–∞–≤–∞—Ç–∏ –∞–±–æ —à–∞–Ω—Å–∏ –Ω–∞ –ø–µ—Ä–µ–º–æ–≥—É –∑–º–µ–Ω—à—É—é—Ç—å—Å—è</li>
                <li><strong>–ñ–∞—Ö</strong> - –°—Ç–∏–∫–∞—é—Ç—å—Å—è –∑ –∂–∞—Ö–ª–∏–≤–æ—é –º–∞–≥—ñ—î—é, —Å—Ç—Ä–∞—Ö—ñ—Ç–ª–∏–≤–æ—é —Ä—ñ–∑–∞–Ω–∏–Ω–æ—é –∞–±–æ –∑–Ω–∞—á–Ω–æ —Å–∏–ª—å–Ω—ñ—à–∏–º –≤–æ—Ä–æ–≥–æ–º</li>
                <li><strong>–¶–∏–≤—ñ–ª—å–Ω—ñ</strong> - –¶–∏–≤—ñ–ª—å–Ω—ñ –≤–ø–µ—Ä—à–µ —Å—Ç–∏–∫–∞—é—Ç—å—Å—è –∑ —Ä–µ–∞–ª—å–Ω–æ—é —Ñ—ñ–∑–∏—á–Ω–æ—é –∑–∞–≥—Ä–æ–∑–æ—é</li>
                <li><strong>–ó–∞—Å—ñ–¥–∫–∞</strong> - –ù–µ–¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–æ–≤–∞–Ω—ñ —Ü—ñ–ª—ñ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –ø—Ä–∏ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω—ñ–π –∑–∞—Å—ñ–¥—Ü—ñ (–Ω–∞ —Ä–æ–∑—Å—É–¥ –ì–ú)</li>
            </ul>
        </div>

        <div class="action-item">
            <h4>–ù–∞—Å–ª—ñ–¥–∫–∏ –ü—Ä–æ–≤–∞–ª—É</h4>
            <ul>
                <li><strong>–¶–∏–≤—ñ–ª—å–Ω—ñ:</strong> –ë–æ–∂–µ–≤—ñ–ª—å–Ω–∞ –≤—Ç–µ—á–∞, –∫–∏–¥–∞—é—Ç—å –≤—Å–µ</li>
                <li><strong>–¢—Ä–µ–Ω–æ–≤–∞–Ω—ñ –±—ñ–π—Ü—ñ:</strong> –ë–æ–π–æ–≤–∏–π –≤—ñ–¥—Å—Ç—É–ø, –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –≤—Ç–µ–∫—Ç–∏ –∑ —Ç–æ–≤–∞—Ä–∏—à–∞–º–∏</li>
                <li><strong>–Ø–∫—â–æ –≤—Ç–µ—á–∞ –Ω–µ–º–æ–∂–ª–∏–≤–∞:</strong> –ó–¥–∞—é—Ç—å—Å—è, –≤–ø–∞–¥–∞—é—Ç—å —É –≤—ñ–¥—á–∞–π, –∞–±–æ –±'—é—Ç—å—Å—è –∑ –ª—é—Ç—Ç—é</li>
            </ul>
        </div>

        <p style="font-size: 0.8rem; color: var(--pico-muted-color);">
            <strong>–¢–∏–ø–æ–≤–∞ –ú–æ—Ä–∞–ª—å:</strong> 2-5 –±–æ—è–≥—É–∑–∏, 6-7 –∑–≤–∏—á–∞–π–Ω—ñ, 8-9 —Ö–æ—Ä–æ–±—Ä—ñ, 10-11 –±–µ–∑—Å—Ç—Ä–∞—à–Ω—ñ, 12 –Ω–µ–∑–ª–∞–º–Ω—ñ. –ü–ì –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∫–∏–¥–∞—é—Ç—å –ú–æ—Ä–∞–ª—å.
        </p>
    </article>

    <!-- Instinct Checks -->
    <article class="cheatsheet-card">
        <h3>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ü–Ω—Å—Ç–∏–Ω–∫—Ç—É</h3>

        <div class="action-item">
            <div class="formula-box">
                <span class="dice" x-data="rollable" data-notation="1d10" @click="roll()" :class="{ 'rolled': rolled }" title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –∫–∏–¥–∫–∞" x-text="displayText">1–∫10</span> &le; –Ü–Ω—Å—Ç–∏–Ω–∫—Ç = <span class="modifier-negative">–ü—Ä–æ–≤–∞–ª</span>
            </div>
            <p>–ü—Ä–∏ –ø—Ä–æ–≤–∞–ª—ñ: –ù–Ü–ü –¥—ñ—î —ñ–º–ø—É–ª—å—Å–∏–≤–Ω–æ, –∫–æ—Ä–æ—Ç–∫–æ–∑–æ—Ä–æ, —ñ–Ω—Å—Ç–∏–Ω–∫—Ç–∏–≤–Ω–æ.</p>
        </div>

        <div class="action-item">
            <h4>–ö–æ–ª–∏ –ö–∏–¥–∞—Ç–∏</h4>
            <ul class="trigger-list">
                <li><strong>–†–∞—É–Ω–¥ 2+</strong> - –î—Ä—É–≥–∏–π —Ä–∞—É–Ω–¥ –±–æ—é –¥–ª—è –Ω–µ–¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–æ–≤–∞–Ω–∏—Ö –±—ñ–π—Ü—ñ–≤</li>
                <li><strong>–ü—ñ—Å–ª—è –ú–æ—Ä–∞–ª—ñ</strong> - –Ü—Å—Ç–æ—Ç–∞ —â–æ–π–Ω–æ —Ä–æ–±–∏–ª–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ú–æ—Ä–∞–ª—ñ</li>
                <li><strong>–ó–±–µ–Ω—Ç–µ–∂–µ–Ω–Ω—è</strong> - –í–æ—Ä–æ–≥ –∑—Ä–æ–±–∏–≤ —â–æ—Å—å –∑–∞–ø–ª—É—Ç–∞–Ω–µ –∞–±–æ –¥–µ–∑–æ—Ä—ñ—î–Ω—Ç—É—é—á–µ</li>
                <li><strong>–ü—Ä–æ–≤–æ–∫–∞—Ü—ñ—è</strong> - –í–æ—Ä–æ–≥ —Ä–æ–∑–ª—é—Ç–∏–≤ –∞–±–æ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑–∞–ª—è–∫–∞–≤ —ñ—Å—Ç–æ—Ç—É</li>
                <li><strong>–°–ø–æ–∫—É—Å–∞</strong> - –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ —â–æ—Å—å –±–∞–∂–∞–Ω–µ (—ó–∂–∞, –≥—Ä–æ—à—ñ —Ç–æ—â–æ)</li>
            </ul>
        </div>

        <div class="action-item">
            <h4>–ü—Ä–∏–∫–ª–∞–¥–∏ –ü—Ä–æ–≤–∞–ª—É</h4>
            <ul>
                <li>–°–ª—ñ–ø–æ –∞—Ç–∞–∫—É—î –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ñ —Ü—ñ–ª—ñ</li>
                <li>–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –±–µ–∑–∑–±—Ä–æ–π–Ω—ñ –∞—Ç–∞–∫–∏ –∑–∞–º—ñ—Å—Ç—å –∑–±—Ä–æ—ó –≤ —Ä—É—Ü—ñ</li>
                <li>–°–ø—Ä—è–º–æ–≤—É—î –∑–∞–∫–ª—è—Ç—Ç—è/–ø–æ—Å—Ç—Ä—ñ–ª–∏ –Ω–∞ –º–µ–Ω—à –≤–∞–∂–ª–∏–≤—ñ —Ü—ñ–ª—ñ</li>
                <li>–ñ–µ–Ω–µ—Ç—å—Å—è –∑–∞ –∫–∏–Ω—É—Ç–æ—é –ø—Ä–∏–º–∞–Ω–∫–æ—é –∑–∞–º—ñ—Å—Ç—å –±–æ—é</li>
            </ul>
        </div>

        <p style="font-size: 0.8rem; color: var(--pico-muted-color);">
            <strong>–¢–∏–ø–æ–≤–∏–π –Ü–Ω—Å—Ç–∏–Ω–∫—Ç:</strong> 5+ –∑–≤—ñ—Ä—ñ/—Ü–∏–≤—ñ–ª—å–Ω—ñ, 3-4 –≤–µ—Ç–µ—Ä–∞–Ω–∏, 1-2 –∑–∞–≥–∞—Ä—Ç–æ–≤–∞–Ω—ñ, 0 –Ω–∞–π—Ö–æ–ª–æ–¥–Ω–æ–∫—Ä–æ–≤–Ω—ñ—à—ñ –≤–±–∏–≤—Ü—ñ. –ü–ì –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∫–∏–¥–∞—é—Ç—å –Ü–Ω—Å—Ç–∏–Ω–∫—Ç. –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ.
        </p>
    </article>

    <!-- Running NPC Combat & Fleeing -->
    <article class="cheatsheet-card">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è –ù–Ü–ü–∞–º–∏</h3>

        <div class="action-item">
            <h4>–ü–æ—Ä–∞–¥–∏ –¥–ª—è –ë–æ—é –ù–Ü–ü—ñ–≤</h4>
            <ul>
                <li>–ù–Ü–ü–∏ –Ω–µ –±'—é—Ç—å—Å—è –¥–æ —Å–º–µ—Ä—Ç—ñ, —è–∫—â–æ –Ω–µ –∑–º—É—à–µ–Ω—ñ</li>
                <li>–ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –ú–æ—Ä–∞–ª—å, –∫–æ–ª–∏ —Å–ø—Ä–∞–≤–∏ –π–¥—É—Ç—å –ø–æ–≥–∞–Ω–æ</li>
                <li>–ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –Ü–Ω—Å—Ç–∏–Ω–∫—Ç –ø—Ä–∏ –∑–±–µ–Ω—Ç–µ–∂–µ–Ω–Ω—ñ –∞–±–æ –ø—Ä–æ–≤–æ–∫–∞—Ü—ñ—ó</li>
                <li>–î–æ–∑–≤–æ–ª—è–π—Ç–µ –ù–Ü–ü–∞–º —Ä–æ–±–∏—Ç–∏ —Ç–∞–∫—Ç–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏ - –≤–æ–Ω–∏ –Ω–µ —ñ–¥–µ–∞–ª—å–Ω—ñ</li>
                <li>–ü—ñ—Å–ª—è –ø—Ä–æ–≤–∞–ª—É –ú–æ—Ä–∞–ª—ñ —Å—Ç–æ—Ä–æ–Ω–∞ –Ω–µ –±–∏—Ç–∏–º–µ—Ç—å—Å—è –∑ —Ç–∏–º–∏ –∂ –≤–æ—Ä–æ–≥–∞–º–∏, –¥–æ–∫–∏ —Å–∏—Ç—É–∞—Ü—ñ—è –Ω–µ –∑–º—ñ–Ω–∏—Ç—å—Å—è</li>
            </ul>
        </div>

        <div class="action-item">
            <h4>–ü–æ—Ä–∞–¥–∏ –¥–ª—è –ì–ú</h4>
            <ul>
                <li>–ë—É–¥—å—Ç–µ –ø–æ–±–ª–∞–∂–ª–∏–≤—ñ —â–æ–¥–æ –≤—Ç–µ—á—ñ –ü–ì</li>
                <li>–ë—ñ–ª—å—à—ñ—Å—Ç—å –ø–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞—á—ñ–≤ –Ω–µ –±—É–¥—É—Ç—å –Ω–µ–≤–ø–∏–Ω–Ω–æ –Ω–∞–ø–æ–ª–µ–≥–ª–∏–≤–∏–º–∏</li>
                <li>–í—Ç–µ—á–∞ - –∂–∏—Ç—Ç—î–∑–¥–∞—Ç–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç, –∞ –Ω–µ –ø—Ä–∏–≤—ñ–¥ –ø–æ–º–µ—Ä—Ç–∏ –≤—Ç–æ–º–ª–µ–Ω–∏–º–∏</li>
            </ul>
        </div>
    </article>

    <!-- Chases -->
    <article class="cheatsheet-card span-2">
        <h3>–ü–æ–≥–æ–Ω—ñ & –ü–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è</h3>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <!-- Foot Chase -->
            <div>
                <h4 style="margin-top: 0;">–ü—ñ—à–∫–∏</h4>
                <ol style="margin: 0; padding-left: 1.2rem; font-size: 0.9rem; color: var(--pico-muted-color);">
                    <li><strong>–¢–µ–º–ø –≤—Ç–µ—á—ñ:</strong> –ù–∞–π–∫—Ä–∞—â–∏–π –°–ü–†/–ê–¢–õ–ï–¢–ò–ö–ê –∞–±–æ –°–¢–ê/–ê–¢–õ–ï–¢–ò–ö–ê —É –≥—Ä—É–ø—ñ –≤—Ç—ñ–∫–∞—á—ñ–≤ = <strong>–¢–µ–º–ø</strong></li>
                    <li><strong>–ü–æ–º—ñ—á–Ω–∏–∫–∏:</strong> –Ü–Ω—à—ñ –≤—Ç—ñ–∫–∞—á—ñ –∑–∞–≤–∞–∂–∞—é—Ç—å –ø–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—é (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞–≤–∏—á–∫–∏ –∞–±–æ —Ä—ñ—à–µ–Ω–Ω—è –ì–ú). –£—Å–ø—ñ—Ö = <span class="modifier-positive">+1</span> –¥–æ –¢–µ–º–ø—É –∫–æ–∂–µ–Ω, –º–∞–∫—Å <span class="modifier-positive">+3</span></li>
                    <li><strong>–ü–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞—á—ñ –∫–∏–¥–∞—é—Ç—å:</strong> –û–¥–∏–Ω –∫–∏–¥–æ–∫ –°–ü–†/–ê–¢–õ–ï–¢–ò–ö–ê –∞–±–æ –°–¢–ê/–ê–¢–õ–ï–¢–ò–ö–ê –∑ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞–º–∏</li>
                    <li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –ü–µ—Ä–µ–≤–∏—â—É—î –¢–µ–º–ø = <span class="modifier-negative">—Å–ø—ñ–π–º–∞–Ω–æ</span>. –†—ñ–≤–Ω–æ –∞–±–æ –º–µ–Ω—à–µ = <span class="modifier-positive">–≤—Ç–µ–∫–ª–∏</span></li>
                </ol>

                <h4 style="margin-top: 0.75rem;">–ú–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ –¢–µ–º–ø—É –ü—ñ—à–∫–∏</h4>
                <div class="instinct-table">
                    <div class="inst-row">
                        <span class="inst-desc">–ë–µ–∑ —Ñ–æ—Ä–∏ –≤–∑–∞–≥–∞–ª—ñ</span>
                        <span class="inst-score">+2</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">–û–¥–∏–Ω —Ä–∞—É–Ω–¥ —Ñ–æ—Ä–∏</span>
                        <span class="inst-score">+1</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">&lt;1 —Ö–≤ —Ñ–æ—Ä–∏</span>
                        <span class="inst-score">+0</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">&gt;1 —Ö–≤ —Ñ–æ—Ä–∏</span>
                        <span class="inst-score">-2</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">–ü–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞—á—ñ–≤ –±—ñ–ª—å—à–µ</span>
                        <span class="inst-score">-1</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">–ó–Ω–∞–Ω–Ω—è –º—ñ—Å—Ü–µ–≤–æ—Å—Ç—ñ</span>
                        <span class="inst-score">-2 –¥–æ +2</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">–ú–ª—è–≤—ñ—Å—Ç—å / –õ—é—Ç—å</span>
                        <span class="inst-score">-1 / +1</span>
                    </div>
                </div>
            </div>

            <!-- Mounted Chase -->
            <div>
                <h4 style="margin-top: 0;">–í–µ—Ä—Ö–∏</h4>
                <ol style="margin: 0; padding-left: 1.2rem; font-size: 0.9rem; color: var(--pico-muted-color);">
                    <li><strong>–¢–µ–º–ø –≤—Ç–µ—á—ñ:</strong> –í—Ç—ñ–∫–∞—á –∫–∏–¥–∞—î –°–ü–†/–á–ó–î–ê = <strong>–¢–µ–º–ø</strong></li>
                    <li><strong>–ö–æ–∂–µ–Ω –ø–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞—á –∫–∏–¥–∞—î:</strong> –°–ü–†/–á–ó–î–ê –∑ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞–º–∏</li>
                    <li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –†—ñ–≤–Ω–æ –∞–±–æ –±—ñ–ª—å—à–µ –¢–µ–º–ø—É = <span class="modifier-negative">–Ω–∞–∑–¥–æ–≥–Ω–∞–≤</span>. –ú–µ–Ω—à–µ = <span class="modifier-positive">–≤—ñ–¥—Å—Ç–∞–≤ & –∑–∞–≥—É–±–∏–≤</span></li>
                </ol>
                <p style="font-size: 0.85rem; color: var(--pico-muted-color); margin: 0.5rem 0;">
                    <strong>–ü—Ä–∏–º—ñ—Ç–∫–∞:</strong> –ü—ñ—à–æ—Ö–æ–¥–∏ –Ω–µ –º–æ–∂—É—Ç—å –Ω–∞–∑–¥–æ–≥–Ω–∞—Ç–∏ –≤–µ—Ä—Ö–æ–≤–∏—Ö —É –∫–æ—Ä–æ—Ç–∫–æ—á–∞—Å–Ω–∏—Ö –ø–æ–≥–æ–Ω—è—Ö.
                </p>

                <h4 style="margin-top: 0.75rem;">–ú–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ –¢–µ–º–ø—É –í–µ—Ä—Ö–∏</h4>
                <div class="instinct-table">
                    <div class="inst-row">
                        <span class="inst-desc">–ù–µ –±–∞—á–∏—Ç—å –≤—Ç—ñ–∫–∞—á–∞ –Ω–∞–ø—Ä—è–º—É</span>
                        <span class="inst-score">-2</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">–ü–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞—á –ª–µ—Ç–∏—Ç—å, –≤—Ç—ñ–∫–∞—á –Ω—ñ</span>
                        <span class="inst-score">+3</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">–í—Ç—ñ–∫–∞—á –ª–µ—Ç–∏—Ç—å, –ø–µ—Ä–µ—Å–ª—ñ–¥—É–≤–∞—á –Ω—ñ</span>
                        <span class="inst-score">-3</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">–°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á –ø–µ—Ä–µ–¥–∞—î –ø–æ–∑–∏—Ü—ñ—é</span>
                        <span class="inst-score">+1</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">–ó–Ω–∞–Ω–Ω—è –º—ñ—Å—Ü–µ–≤–æ—Å—Ç—ñ</span>
                        <span class="inst-score">-2 –¥–æ +2</span>
                    </div>
                    <div class="inst-row">
                        <span class="inst-desc">–ú–ª—è–≤—ñ—Å—Ç—å / –õ—é—Ç—å</span>
                        <span class="inst-score">-1 / +1</span>
                    </div>
                </div>
            </div>
        </div>
    </article>

</div>

<footer style="text-align: center; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--pico-muted-border-color);">
    <small>WWN –≤—ñ–¥ –ö–µ–≤—ñ–Ω–∞ –ö—Ä–æ—É—Ñ–æ—Ä–¥–∞. –ó–º—ñ—Å—Ç —à–ø–∞—Ä–≥–∞–ª–∫–∏ –∑—ñ–±—Ä–∞–Ω–æ –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –¥–æ–≤—ñ–¥–Ω–∏–∫–∞.</small>
</footer>

<!-- Alpine.js + Simple Dice Roller -->
<script>
    // Simple dice roller - supports notation like "2d6", "1d8+2", "3d6-1"
    function rollDice(notation) {
        const match = notation.match(/^(\d+)?[d–∫–∫](\d+)([+-]\d+)?$/i);
        if (!match) return null;
        const count = parseInt(match[1]) || 1;
        const sides = parseInt(match[2]);
        const modifier = parseInt(match[3]) || 0;
        const rolls = Array.from({length: count}, () => Math.floor(Math.random() * sides) + 1);
        return { total: rolls.reduce((a, b) => a + b, 0) + modifier, rolls };
    }

    // Register Alpine components BEFORE Alpine loads
    document.addEventListener('alpine:init', () => {
        // Turn tracker component
        Alpine.data('turnTracker', () => ({
            turns: 0,
            get time() {
                const mins = this.turns * 10;
                const h = Math.floor(mins / 60);
                const m = mins % 60;
                if (h > 0 && m > 0) return `${h}–≥${m}—Ö–≤`;
                if (h > 0) return `${h}–≥`;
                if (m > 0) return `${m}—Ö–≤`;
                return '';
            }
        }));

        // Rollable dice component
        Alpine.data('rollable', () => ({
            notation: '',
            displayText: '',
            rolled: false,
            timeout: null,
            clickHandler: null,

            init() {
                this.notation = this.$el.dataset.notation || this.$el.textContent.trim();
                this.displayText = this.notation;
            },

            roll() {
                this.reset();
                const r = rollDice(this.notation);
                if (r) {
                    this.displayText = `${r.total} [${r.rolls.join(',')}]`;
                    this.rolled = true;

                    // Reset after 3 seconds
                    this.timeout = setTimeout(() => this.reset(), 3000);

                    // Reset on click anywhere else
                    this.clickHandler = (e) => {
                        if (e.target !== this.$el) this.reset();
                    };
                    setTimeout(() => document.addEventListener('click', this.clickHandler, { once: true }), 10);
                }
            },

            reset() {
                if (this.timeout) clearTimeout(this.timeout);
                if (this.clickHandler) document.removeEventListener('click', this.clickHandler);
                this.displayText = this.notation;
                this.rolled = false;
                this.timeout = null;
                this.clickHandler = null;
            }
        }));
    });
</script>
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js"></script>
{% endblock %}
